async function o(){const{profile:t}=await chrome.storage.local.get(["profile"]);return t||{fullName:"",firstName:"",lastName:"",email:"",phone:"",company:"",jobTitle:"",address1:"",address2:"",city:"",state:"",zip:"",country:"",website:"",linkedin:"",customFields:[]}}async function c(){const{rules:t}=await chrome.storage.local.get(["rules"]);return t||[]}async function u(t){await chrome.storage.local.set({rules:t})}chrome.runtime.onInstalled.addListener(()=>{console.log("SmartFill installed")});chrome.runtime.onMessage.addListener((t,s,e)=>((async()=>{switch(t==null?void 0:t.type){case"PING":e({ok:!0,ts:Date.now()});break;case"GET_PROFILE":{const r=await o();e({profile:r});break}case"SAVE_PROFILE":{await chrome.storage.local.set({profile:t.profile}),e({ok:!0});break}case"GET_RULES":{const r=await c();e({ok:!0,rules:r});break}case"SAVE_RULES":{await u(t.rules||[]),e({ok:!0});break}case"AUTOFILL_ACTIVE":{const[r]=await chrome.tabs.query({active:!0,currentWindow:!0}),i=t.profile||await o(),l=await c();if(r!=null&&r.id)try{const a=await chrome.tabs.sendMessage(r.id,{type:"AUTOFILL",profile:i,rules:l});e(a||{ok:!0})}catch(a){e({ok:!1,error:a==null?void 0:a.message})}else e({ok:!1,error:"No active tab"});break}default:e({ok:!1,error:"Unknown message type"})}})(),!0));
